# å‰åŽç«¯è¿žæŽ¥é—®é¢˜è¯Šæ–­æŒ‡å—

## âœ… åŽç«¯æµ‹è¯•ç»“æžœ
æ ¹æ® `test_connection.py` çš„è¯Šæ–­ç»“æžœï¼Œ**åŽç«¯åŠŸèƒ½å®Œå…¨æ­£å¸¸**ï¼š
- âœ… åŽç«¯è¿žæŽ¥æ­£å¸¸
- âœ… æ³¨å†ŒæŽ¥å£å¯è¾¾
- âœ… æ³¨å†Œé€»è¾‘æ­£å¸¸
- âœ… CORSé…ç½®æ­£å¸¸

## ðŸ” å‰ç«¯è¯Šæ–­æ­¥éª¤

### æ­¥éª¤1: æ£€æŸ¥æµè§ˆå™¨æŽ§åˆ¶å°

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° **Networkï¼ˆç½‘ç»œï¼‰** æ ‡ç­¾
3. å°è¯•æ³¨å†Œä¸€ä¸ªæ–°ç”¨æˆ·
4. æŸ¥çœ‹æ˜¯å¦æœ‰å¯¹ `http://localhost:8000/auth/register` çš„è¯·æ±‚

**åˆ¤æ–­æ ‡å‡†ï¼š**
- **å¦‚æžœçœ‹åˆ°è¯·æ±‚**ï¼š
  - æŸ¥çœ‹è¯·æ±‚çŠ¶æ€ç ï¼š
    - `200/201` = æˆåŠŸï¼Œé—®é¢˜åœ¨å‰ç«¯å¤„ç†é€»è¾‘
    - `400` = æ•°æ®éªŒè¯å¤±è´¥ï¼Œæ£€æŸ¥å‘é€çš„æ•°æ®æ ¼å¼
    - `500` = åŽç«¯é”™è¯¯ï¼ŒæŸ¥çœ‹å“åº”å†…å®¹
    - `CORS error` = CORSé—®é¢˜
    - `ERR_NETWORK` / `ERR_EMPTY_RESPONSE` = è¿žæŽ¥é—®é¢˜
  
- **å¦‚æžœæ²¡æœ‰çœ‹åˆ°è¯·æ±‚**ï¼š
  - é—®é¢˜åœ¨å‰ç«¯ä»£ç ï¼Œè¯·æ±‚å¯èƒ½æ²¡æœ‰å‘é€
  - æ£€æŸ¥ `RegisterPage.jsx` ä¸­çš„é”™è¯¯å¤„ç†

### æ­¥éª¤2: æ£€æŸ¥å‰ç«¯APIé…ç½®

åœ¨æµè§ˆå™¨æŽ§åˆ¶å°çš„ **Consoleï¼ˆæŽ§åˆ¶å°ï¼‰** ä¸­è¿è¡Œï¼š

```javascript
// æ£€æŸ¥API URLé…ç½®
console.log('API URL:', import.meta.env.VITE_API_URL || 'http://localhost:8000');

// æµ‹è¯•APIè¿žæŽ¥
fetch('http://localhost:8000/health')
  .then(r => r.json())
  .then(data => console.log('âœ… åŽç«¯è¿žæŽ¥æ­£å¸¸:', data))
  .catch(err => console.error('âŒ åŽç«¯è¿žæŽ¥å¤±è´¥:', err));
```

**é¢„æœŸç»“æžœï¼š**
- åº”è¯¥çœ‹åˆ° `âœ… åŽç«¯è¿žæŽ¥æ­£å¸¸: {status: "healthy"}`
- å¦‚æžœå¤±è´¥ï¼Œè¯´æ˜Žæ˜¯ç½‘ç»œè¿žæŽ¥é—®é¢˜

### æ­¥éª¤3: æ‰‹åŠ¨æµ‹è¯•æ³¨å†ŒæŽ¥å£

åœ¨æµè§ˆå™¨æŽ§åˆ¶å°è¿è¡Œï¼š

```javascript
// æ‰‹åŠ¨æµ‹è¯•æ³¨å†ŒæŽ¥å£
fetch('http://localhost:8000/auth/register', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    username: 'test_' + Date.now(),
    password: 'test123456',
    gender: 'male',
    preferred_gender: 'female'
  })
})
  .then(r => r.json())
  .then(data => console.log('âœ… æ³¨å†ŒæˆåŠŸ:', data))
  .catch(err => console.error('âŒ æ³¨å†Œå¤±è´¥:', err));
```

**åˆ¤æ–­æ ‡å‡†ï¼š**
- **å¦‚æžœæˆåŠŸ**ï¼šè¯´æ˜ŽåŽç«¯å’Œç½‘ç»œéƒ½æ­£å¸¸ï¼Œé—®é¢˜åœ¨å‰ç«¯ä»£ç é€»è¾‘
- **å¦‚æžœå¤±è´¥**ï¼šæŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œå¯èƒ½æ˜¯CORSæˆ–è¿žæŽ¥é—®é¢˜

### æ­¥éª¤4: æ£€æŸ¥å‰ç«¯ä»£ç ä¸­çš„APIè°ƒç”¨

æ£€æŸ¥ `src/services/api.js` ä¸­çš„é…ç½®ï¼š

```javascript
const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:8000';
```

**ç¡®è®¤ï¼š**
- å¦‚æžœæ²¡æœ‰ `.env` æ–‡ä»¶ï¼Œä¼šä½¿ç”¨é»˜è®¤å€¼ `http://localhost:8000`
- å¦‚æžœå‰ç«¯è¿è¡Œåœ¨ `http://127.0.0.1:5173`ï¼Œç¡®ä¿åŽç«¯ä¹Ÿå…è®¸è¯¥æ¥æº

### æ­¥éª¤5: æ£€æŸ¥Viteé…ç½®

ç¡®è®¤ `vite.config.js` ä¸­çš„é…ç½®ï¼š

```javascript
server: {
  host: true  // å…è®¸å¤–éƒ¨è®¿é—®
}
```

## ðŸŽ¯ å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1: ERR_NETWORK / ERR_EMPTY_RESPONSE

**å¯èƒ½åŽŸå› ï¼š**
- åŽç«¯æœªè¿è¡Œ
- ç«¯å£è¢«å ç”¨
- é˜²ç«å¢™é˜»æ­¢

**è§£å†³æ–¹æ¡ˆï¼š**
```powershell
# æ£€æŸ¥åŽç«¯æ˜¯å¦è¿è¡Œ
netstat -ano | findstr :8000

# å¦‚æžœæ²¡è¿è¡Œï¼Œå¯åŠ¨åŽç«¯
cd codespace\backend
.\venv\Scripts\activate
uvicorn app.main:socket_app --host 0.0.0.0 --port 8000 --reload
```

### é—®é¢˜2: CORSé”™è¯¯

**ç—‡çŠ¶ï¼š** æµè§ˆå™¨æŽ§åˆ¶å°æ˜¾ç¤º CORS ç›¸å…³é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
- åŽç«¯CORSé…ç½®å·²æ­£ç¡®ï¼ˆä½¿ç”¨æ­£åˆ™åŒ¹é…æ‰€æœ‰æ¥æºï¼‰
- å¦‚æžœä»æœ‰é—®é¢˜ï¼Œæ£€æŸ¥æµè§ˆå™¨æ˜¯å¦ç¼“å­˜äº†æ—§çš„CORSç­–ç•¥
- å°è¯•æ¸…é™¤æµè§ˆå™¨ç¼“å­˜æˆ–ä½¿ç”¨æ— ç—•æ¨¡å¼

### é—®é¢˜3: è¯·æ±‚å‘é€ä½†è¿”å›žé”™è¯¯

**æ£€æŸ¥ï¼š**
1. æŸ¥çœ‹Networkæ ‡ç­¾ä¸­çš„è¯·æ±‚è¯¦æƒ…
2. æ£€æŸ¥è¯·æ±‚çš„Payloadï¼ˆå‘é€çš„æ•°æ®ï¼‰
3. æ£€æŸ¥å“åº”çš„å†…å®¹

**å¸¸è§é”™è¯¯ï¼š**
- `422 Unprocessable Entity` = æ•°æ®æ ¼å¼é”™è¯¯ï¼Œæ£€æŸ¥å­—æ®µåå’Œç±»åž‹
- `400 Bad Request` = ä¸šåŠ¡é€»è¾‘é”™è¯¯ï¼ˆå¦‚ç”¨æˆ·åå·²å­˜åœ¨ï¼‰
- `500 Internal Server Error` = åŽç«¯ä»£ç é”™è¯¯ï¼ŒæŸ¥çœ‹åŽç«¯æ—¥å¿—

## ðŸ“‹ è¯Šæ–­æ£€æŸ¥æ¸…å•

- [ ] åŽç«¯æ˜¯å¦è¿è¡Œï¼Ÿï¼ˆ`netstat -ano | findstr :8000`ï¼‰
- [ ] åŽç«¯å¥åº·æ£€æŸ¥æ˜¯å¦é€šè¿‡ï¼Ÿï¼ˆè®¿é—® `http://localhost:8000/health`ï¼‰
- [ ] æµè§ˆå™¨Networkæ ‡ç­¾ä¸­æ˜¯å¦çœ‹åˆ°æ³¨å†Œè¯·æ±‚ï¼Ÿ
- [ ] è¯·æ±‚çš„URLæ˜¯å¦æ­£ç¡®ï¼Ÿï¼ˆ`http://localhost:8000/auth/register`ï¼‰
- [ ] è¯·æ±‚çš„Methodæ˜¯å¦ä¸ºPOSTï¼Ÿ
- [ ] è¯·æ±‚çš„Content-Typeæ˜¯å¦ä¸º`application/json`ï¼Ÿ
- [ ] è¯·æ±‚çš„Bodyæ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Ÿ
- [ ] æµè§ˆå™¨æŽ§åˆ¶å°æ˜¯å¦æœ‰JavaScripté”™è¯¯ï¼Ÿ
- [ ] æ˜¯å¦æœ‰CORSç›¸å…³é”™è¯¯ï¼Ÿ

## ðŸš€ å¿«é€Ÿæµ‹è¯•å‘½ä»¤

åœ¨åŽç«¯ç›®å½•è¿è¡Œè¯Šæ–­è„šæœ¬ï¼š
```powershell
cd codespace\backend
python test_connection.py
```

åœ¨æµè§ˆå™¨æŽ§åˆ¶å°æµ‹è¯•è¿žæŽ¥ï¼š
```javascript
fetch('http://localhost:8000/health').then(r => r.json()).then(console.log)
```

