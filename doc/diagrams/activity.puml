@startuml
left to right direction
skinparam packageStyle rectangle

actor "User A" as UA
actor "User B" as UB
actor "AI System" as AI

rectangle "Random Chat Session" {
  usecase "Start Random Match" as UC_Match
  usecase "Chat with Stranger" as UC_ChatRandom
  usecase "View Stranger Profile" as UC_ViewProfile
}

rectangle "AI Safety & Enhancement" {
  usecase "Detect Abusive Content" as UC_AI_Safety
  usecase "Analyze Conversation Mood" as UC_AI_Atmosphere
  usecase "Get Wingman Advice" as UC_AI_Wingman
}

rectangle "AI Fallback" {
  usecase "Chat with AI Companion" as UC_AI_Companion
}

rectangle "Connection Establishment" {
  usecase "Send Datemate Request" as UC_SendReq
  usecase "Accept/Reject Request" as UC_HandleReq
  usecase "Establish Datemate Connection" as UC_EstablishConn
}

' Main Flow
UA --> UC_Match
UC_Match ..> UC_ViewProfile : <<include>>
UC_Match ..> UC_ChatRandom : <<include>>\n(user found)
UC_Match ..> UC_AI_Companion : <<extend>>\n(no user)

' Random Chat interactions
UC_ChatRandom --> UA
UC_ChatRandom --> UB

' AI Safety & Enhancement
UC_ChatRandom ..> UC_AI_Safety : <<include>>
UC_AI_Safety --> AI

UC_ChatRandom ..> UC_AI_Atmosphere : <<include>>
UC_AI_Atmosphere --> AI

UC_ChatRandom ..> UC_AI_Wingman : <<extend>>
UC_AI_Wingman --> AI

' Connection Request Flow
UC_ChatRandom ..> UC_SendReq : <<extend>>
UC_SendReq --> UA
UC_SendReq --> UB

UB --> UC_HandleReq
UC_HandleReq ..> UC_EstablishConn : <<include>>\n(accept)

' AI Companion
UC_AI_Companion --> AI

@enduml
