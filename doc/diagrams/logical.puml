@startuml
skinparam classAttributeIconSize 0

class User {
  +UUID userId
  +String nickname
  +String email
  +Profile profile
  +UserStatus status
  +List<Connection> datemates
  --
  +requestMatch()
  +postContent()
  +sendDatemateRequest(User)
}

class Profile {
  +String bio
  +List<String> interests
  +List<String> photoWall
  +Map<String, String> preferences
  +Integer age
  +String location
  --
  +updateProfile()
  +getBasicInfo()
}

class Connection {
  +UUID connectionId
  +User initiator
  +User receiver
  +ConnectionStatus status
  +Date establishedAt
  --
  +accept()
  +reject()
  +block()
}

enum ConnectionStatus {
  PENDING
  ACCEPTED
  REJECTED
  BLOCKED
}

abstract class ChatSession {
  +UUID sessionId
  +User participantA
  +User participantB
  +List<Message> history
  +Date startTime
  +Boolean isActive
  --
  +sendMessage(content)
  +endSession()
}

class RandomChatSession {
  +Boolean datemateRequestSent
  +MatchingScore matchScore
  --
  +sendDatemateRequest()
  +getAtmosphereScore()
}

class PrivateChatSession {
  +Connection linkedConnection
  --
  +archive()
  +exportHistory()
}

class Message {
  +UUID messageId
  +User sender
  +String content
  +Timestamp sentAt
  +ContentType type
  +Boolean isFlagged
  +Boolean isAIGenerated
  --
  +flag()
}

class Post {
  +UUID postId
  +User author
  +String text
  +List<String> imageUrls
  +Integer likeCount
  +List<Comment> comments
  +List<String> tags
  +Date publishedAt
  --
  +addComment(Comment)
  +like(User)
}

class Comment {
  +UUID commentId
  +User author
  +String content
  +Date createdAt
}

interface AIService {
  +detectAbuse(Message) : SafetyReport
  +suggestReply(ChatSession, Profile) : String
  +analyzeSentiment(List<Message>) : AtmosphereReport
  +generateCompanionResponse(String) : String
  +simulatePartner(List<Message>) : String
  +optimizeProfile(Profile) : List<Suggestion>
  +matchUsers(User, List<User>) : MatchingScore
}

class SafetyReport {
  +Boolean isAbusive
  +Float confidenceScore
  +List<String> reasons
}

class AtmosphereReport {
  +String mood
  +Float positivityScore
  +List<String> suggestions
}

' Relationships
User "1" *-- "1" Profile
User "1" --> "*" Connection : has datemates
User "1" --> "*" Post : publishes
User "1" --> "*" ChatSession : participates

Connection "1" -- "2" User
Connection ..> ConnectionStatus

ChatSession <|-- RandomChatSession
ChatSession <|-- PrivateChatSession
ChatSession "1" *-- "*" Message

PrivateChatSession --> Connection : belongs to

Post "1" *-- "*" Comment
Post --> User : authored by
Comment --> User : authored by

' AI Integration
Message ..> AIService : analyzed by
RandomChatSession ..> AIService : uses Wingman/Atmosphere
Post ..> AIService : moderated by
Profile ..> AIService : optimized by
User ..> AIService : matched by

SafetyReport <.. AIService
AtmosphereReport <.. AIService

note right of RandomChatSession
  Used for anonymous matching.
  Datemate request can be sent
  after good conversation.
end note

note right of PrivateChatSession
  Only available between
  accepted datemates.
end note

@enduml
